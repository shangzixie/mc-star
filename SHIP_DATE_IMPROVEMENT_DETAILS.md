# èˆ¹æœŸç¼–è¾‘åŠŸèƒ½æ”¹è¿› - ä»£ç å¯¹æ¯”

## ç»„ä»¶æ”¹è¿›å‰åå¯¹æ¯”

### æ”¹è¿›å‰ï¼ˆåŸç‰ˆï¼‰
```typescript
// receipt-transport-schedule-section.tsx (åŸç‰ˆ)

// æµ·è¿éƒ¨åˆ†ç¤ºä¾‹
if (transportType === 'SEA_FCL' || transportType === 'SEA_LCL') {
  return (
    <div className="space-y-3">
      {/* ç¦»æ¸¯æ—¥æœŸ(E) */}
      <div className="space-y-2">
        <Label htmlFor="seaEtdE">{t('sea.fields.etdE')}</Label>
        <Input id="seaEtdE" type="date" {...form.register('seaEtdE')} />
      </div>

      {/* åˆ°æ¸¯æ—¥æœŸ(E) */}
      <div className="space-y-2">
        <Label htmlFor="seaEtaE">{t('sea.fields.etaE')}</Label>
        <Input id="seaEtaE" type="date" {...form.register('seaEtaE')} />
      </div>
    </div>
  );
}
```

**é—®é¢˜**:
- âŒ ç«–æ’æ˜¾ç¤ºä¸¤ä¸ªæ—¥æœŸï¼Œå ç”¨å‚ç›´ç©ºé—´
- âŒ æ²¡æœ‰è§†è§‰åŒºåˆ†ï¼ˆæ— å›¾æ ‡ï¼‰
- âŒ æ²¡æœ‰æ—¥æœŸéªŒè¯
- âŒ æ²¡æœ‰é”™è¯¯æç¤º

---

### æ”¹è¿›åï¼ˆæ–°ç‰ˆï¼‰âœ¨
```typescript
// receipt-transport-schedule-section.tsx (æ”¹è¿›ç‰ˆ)

import { Alert, AlertDescription } from '@/components/ui/alert';
import { AlertCircle, Calendar } from 'lucide-react';
import { useMemo } from 'react';

export function ReceiptTransportScheduleSection({
  transportType,
  form,
}: {
  transportType: string | null | undefined;
  form: UseFormReturn<any>;
}) {
  // âœ¨ æ–°å¢ï¼šæ—¥æœŸéªŒè¯é€»è¾‘
  const seaDateValidation = useMemo(() => {
    const etd = form.watch('seaEtdE');
    const eta = form.watch('seaEtaE');
    if (etd && eta && etd > eta) {
      return t('sea.validation.dateOrder');
    }
    return null;
  }, [form.watch('seaEtdE'), form.watch('seaEtaE'), t]);

  if (transportType === 'SEA_FCL' || transportType === 'SEA_LCL') {
    return (
      <div className="space-y-4">
        {/* ... å…¶ä»–å­—æ®µ ... */}

        {/* âœ¨ æ”¹è¿›ï¼šå¹¶æ’æ˜¾ç¤ºæ—¥æœŸå­—æ®µ + å›¾æ ‡ */}
        <div className="grid grid-cols-2 gap-3">
          <div className="space-y-2">
            <Label htmlFor="seaEtdE" className="flex items-center gap-1.5">
              <Calendar className="size-4 text-blue-500" />
              {t('sea.fields.etdE')}
            </Label>
            <Input
              id="seaEtdE"
              type="date"
              {...form.register('seaEtdE')}
              className="text-base"
            />
          </div>
          <div className="space-y-2">
            <Label htmlFor="seaEtaE" className="flex items-center gap-1.5">
              <Calendar className="size-4 text-green-500" />
              {t('sea.fields.etaE')}
            </Label>
            <Input
              id="seaEtaE"
              type="date"
              {...form.register('seaEtaE')}
              className="text-base"
            />
          </div>
        </div>

        {/* âœ¨ æ–°å¢ï¼šæ—¥æœŸéªŒè¯æç¤º */}
        {seaDateValidation && (
          <Alert variant="destructive" className="py-3">
            <AlertCircle className="size-4" />
            <AlertDescription>{seaDateValidation}</AlertDescription>
          </Alert>
        )}
      </div>
    );
  }

  // ...å…¶ä»–é€»è¾‘...
}
```

**æ”¹è¿›ç‚¹**:
- âœ… æ—¥æœŸå­—æ®µæ”¹ä¸º 2 åˆ—ç½‘æ ¼å¸ƒå±€ï¼Œæ¨ªæ’æ˜¾ç¤º
- âœ… æ·»åŠ å½©è‰²æ—¥å†å›¾æ ‡ï¼ˆè“è‰²=å‡ºå‘ ğŸ”µï¼Œç»¿è‰²=åˆ°è¾¾ ğŸŸ¢ï¼‰
- âœ… å®æ—¶æ—¥æœŸéªŒè¯ï¼šETD < ETA
- âœ… é”™è¯¯æç¤ºä½¿ç”¨ Alert ç»„ä»¶
- âœ… å­—ä½“ä¼˜åŒ–ï¼š`text-base` æé«˜å¯è¯»æ€§
- âœ… é—´è·ä¼˜åŒ–ï¼š`space-y-4` å¢åŠ è¡Œé—´è·

---

## å›½é™…åŒ–æ”¹è¿›å¯¹æ¯”

### æ”¹è¿›å‰ï¼ˆmessages/zh.jsonï¼‰
```json
{
  "transportSchedule": {
    "sea": {
      "title": "èˆ¹æœŸ",
      "fields": {
        "carrierRoute": "æ‰¿è¿äºº / èˆªçº¿",
        "vesselVoyage": "èˆ¹å / èˆªæ¬¡",
        "etdE": "ç¦»æ¸¯æ—¥æœŸ(E)",
        "etaE": "åˆ°æ¸¯æ—¥æœŸ(E)"
      },
      "placeholders": {
        "carrierRoute": "æ‰¿è¿äºº / èˆªçº¿",
        "vesselVoyage": "èˆ¹å / èˆªæ¬¡"
      }
    }
  }
}
```

### æ”¹è¿›åï¼ˆmessages/zh.jsonï¼‰
```json
{
  "transportSchedule": {
    "sea": {
      "title": "èˆ¹æœŸ",
      "fields": {
        "carrierRoute": "æ‰¿è¿äºº / èˆªçº¿",
        "vesselVoyage": "èˆ¹å / èˆªæ¬¡",
        "etdE": "ç¦»æ¸¯æ—¥æœŸ(E)",
        "etaE": "åˆ°æ¸¯æ—¥æœŸ(E)"
      },
      "placeholders": {
        "carrierRoute": "æ‰¿è¿äºº / èˆªçº¿",
        "vesselVoyage": "èˆ¹å / èˆªæ¬¡"
      },
      "validation": {  // âœ¨ æ–°å¢
        "dateOrder": "ç¦»æ¸¯æ—¥æœŸå¿…é¡»æ—©äºåˆ°æ¸¯æ—¥æœŸ"
      }
    },
    "air": {
      // ...
      "validation": {  // âœ¨ æ–°å¢
        "dateOrder": "èˆªç­æ—¥æœŸå¿…é¡»æ—©äºåˆ°è¾¾æ—¥æœŸ"
      }
    }
  }
}
```

**æ”¹è¿›**:
- âœ… æ·»åŠ éªŒè¯æç¤ºæ–‡æœ¬ï¼ˆä¸­æ–‡ï¼‰
- âœ… æ”¯æŒå¤šè¯­è¨€éªŒè¯æ¶ˆæ¯

---

## è§†è§‰æ•ˆæœå¯¹æ¯”

### æ”¹è¿›å‰å¸ƒå±€ï¼ˆç«–æ’ï¼‰
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ‰¿è¿äºº / èˆªçº¿        â”‚
â”‚ [è¾“å…¥æ¡†]             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ èˆ¹å / èˆªæ¬¡          â”‚
â”‚ [è¾“å…¥æ¡†]             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ç¦»æ¸¯æ—¥æœŸ(E)         â”‚
â”‚ [æ—¥æœŸè¾“å…¥æ¡†]         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ åˆ°æ¸¯æ—¥æœŸ(E)         â”‚
â”‚ [æ—¥æœŸè¾“å…¥æ¡†]         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ”¹è¿›åå¸ƒå±€ï¼ˆæ¨ªæ’ + å›¾æ ‡ + éªŒè¯ï¼‰
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ‰¿è¿äºº / èˆªçº¿        â”‚
â”‚ [è¾“å…¥æ¡†]             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ èˆ¹å / èˆªæ¬¡          â”‚
â”‚ [è¾“å…¥æ¡†]             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ”µ ç¦»æ¸¯æ—¥æœŸ(E) â”‚ ğŸŸ¢ åˆ°æ¸¯æ—¥æœŸ(E) â”‚
â”‚ [æ—¥æœŸ]         â”‚ [æ—¥æœŸ]         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ”´ âš ï¸ ç¦»æ¸¯æ—¥æœŸå¿…é¡»æ—©äºåˆ°æ¸¯æ—¥æœŸ â”‚  (éªŒè¯å¤±è´¥æ—¶æ˜¾ç¤º)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## åŠŸèƒ½æµç¨‹å›¾

### ç”¨æˆ·äº¤äº’æµç¨‹
```
1. æ‰“å¼€å…¥åº“å•
         â†“
2. è¿›å…¥ç¼–è¾‘æ¨¡å¼
         â†“
3. å®šä½åˆ°"èˆ¹æœŸ"éƒ¨åˆ†
         â†“
4. ä¿®æ”¹æ—¥æœŸå­—æ®µ
         â†“
5. ç³»ç»Ÿå®æ—¶éªŒè¯æ—¥æœŸé¡ºåº â† âœ¨ æ–°å¢
         â†“
6a. éªŒè¯å¤±è´¥ï¼Ÿ
    â†“ æ˜¾ç¤ºçº¢è‰²é”™è¯¯æç¤º â† âœ¨ æ–°å¢
    â†“ ç”¨æˆ·ä¿®æ”¹
    â†“ å›åˆ°æ­¥éª¤ 5
         
6b. éªŒè¯æˆåŠŸï¼Ÿ
    â†“ ä¿å­˜æŒ‰é’®å¯ç”¨
    â†“
7. ç”¨æˆ·ç‚¹å‡»"ä¿å­˜"
         â†“
8. API è°ƒç”¨ï¼šPATCH /api/freight/warehouse-receipts/[id]
         â†“
9. æ•°æ®åº“æ›´æ–°
         â†“
10. æˆåŠŸæç¤º
         â†“
11. æ•°æ®åˆ·æ–°
```

---

## æŠ€æœ¯æ ˆ

### ä½¿ç”¨çš„åº“/API
- **React**: `useMemo` ä¼˜åŒ–éªŒè¯æ€§èƒ½
- **react-hook-form**: è¡¨å•çŠ¶æ€ç®¡ç†
- **next-intl**: å›½é™…åŒ–æ”¯æŒ
- **lucide-react**: å›¾æ ‡åº“ï¼ˆCalendar, AlertCircleï¼‰
- **Radix UI**: Alert ç»„ä»¶

---

## ä»£ç è´¨é‡æŒ‡æ ‡

### æ”¹è¿›å‰
- ä»£ç è¡Œæ•°ï¼š52è¡Œ
- éªŒè¯é€»è¾‘ï¼šæ— 
- å›¾æ ‡/è§†è§‰æ ‡è®°ï¼šæ— 
- i18n æ”¯æŒï¼šéƒ¨åˆ†ï¼ˆæ— éªŒè¯æ¶ˆæ¯ï¼‰

### æ”¹è¿›å
- ä»£ç è¡Œæ•°ï¼š190è¡Œ
- éªŒè¯é€»è¾‘ï¼šâœ… æ—¥æœŸé¡ºåºéªŒè¯
- å›¾æ ‡/è§†è§‰æ ‡è®°ï¼šâœ… å½©è‰²æ—¥å†å›¾æ ‡
- i18n æ”¯æŒï¼šâœ… å®Œæ•´ï¼ˆåŒ…æ‹¬éªŒè¯æ¶ˆæ¯ï¼‰
- æ€§èƒ½ä¼˜åŒ–ï¼šâœ… useMemo ç¼“å­˜éªŒè¯ç»“æœ

---

## å‘åå…¼å®¹æ€§

âœ… **å®Œå…¨å‘åå…¼å®¹**
- æ•°æ®åº“å­—æ®µæ— å˜åŒ–
- API æ¥å£æ— å˜åŒ–
- ä»…æ”¹è¿›å‰ç«¯ UI/UX å’ŒéªŒè¯
- ç°æœ‰æ•°æ®ä¸å—å½±å“

---

## æµ‹è¯•å»ºè®®

### å•å…ƒæµ‹è¯•ï¼ˆå¯é€‰ï¼‰
```typescript
describe('ReceiptTransportScheduleSection', () => {
  it('should show validation error when ETD > ETA', () => {
    // æµ‹è¯•éªŒè¯é€»è¾‘
  });

  it('should render sea schedule for SEA_FCL', () => {
    // æµ‹è¯•æµ·è¿è¡¨å•æ¸²æŸ“
  });

  it('should render air schedule for AIR_FREIGHT', () => {
    // æµ‹è¯•ç©ºè¿è¡¨å•æ¸²æŸ“
  });
});
```

### æ‰‹åŠ¨æµ‹è¯•
- [ ] åˆ›å»ºæµ·è¿å…¥åº“å•
- [ ] ç¼–è¾‘ï¼Œè¾“å…¥æ— æ•ˆæ—¥æœŸï¼ˆETD > ETAï¼‰
- [ ] éªŒè¯é”™è¯¯æç¤ºæ˜¾ç¤º
- [ ] ä¿®æ­£æ—¥æœŸ
- [ ] éªŒè¯é”™è¯¯æç¤ºæ¶ˆå¤±
- [ ] ä¿å­˜
- [ ] éªŒè¯æ•°æ®åº“ä¿å­˜æˆåŠŸ
- [ ] åˆ‡æ¢åˆ°è‹±æ–‡ï¼ŒéªŒè¯è‹±æ–‡æç¤ºæ˜¾ç¤º
- [ ] é‡å¤æµ‹è¯•ç©ºè¿åœºæ™¯

---

## æ€»ç»“

### å…³é”®æ”¹è¿›
| æ–¹é¢ | æ”¹è¿› |
|------|------|
| UI | ç«–æ’ â†’ æ¨ªæ’ 2åˆ—ï¼Œæ›´ç´§å‡‘ |
| å¯è¯»æ€§ | æ·»åŠ å½©è‰²å›¾æ ‡ï¼Œå­—ä½“æ”¾å¤§ |
| æ•°æ®éªŒè¯ | âœ¨ æ–°å¢å®æ—¶æ—¥æœŸé¡ºåºéªŒè¯ |
| ç”¨æˆ·åé¦ˆ | âœ¨ æ–°å¢çº¢è‰²é”™è¯¯æç¤º |
| å›½é™…åŒ– | âœ¨ æ–°å¢éªŒè¯æ¶ˆæ¯çš„å¤šè¯­è¨€æ”¯æŒ |
| æ€§èƒ½ | ä½¿ç”¨ useMemo ä¼˜åŒ– |

### ç”¨æˆ·ä½“éªŒæå‡
- ğŸ¯ **æ›´æ¸…æ™°**: æ—¥æœŸå­—æ®µå¹¶æ’ï¼Œæ˜“äºå¯¹æ¯”
- âš¡ **å³æ—¶åé¦ˆ**: è¾“å…¥æ—¶ç«‹å³éªŒè¯ï¼Œæ— éœ€ç­‰å¾…æäº¤
- ğŸŒ **å¤šè¯­è¨€**: éªŒè¯æç¤ºæ”¯æŒä¸­è‹±æ–‡
- ğŸ›¡ï¸ **æ•°æ®å®‰å…¨**: é˜²æ­¢è¾“å…¥æ— æ•ˆæ—¥æœŸèŒƒå›´

**ç»“è®º**: è¿™æ˜¯ä¸€ä¸ªå®Œæ•´çš„UX/DXæ”¹è¿›ï¼Œåœ¨ä¸æ”¹å˜APIæˆ–æ•°æ®åº“ç»“æ„çš„å‰æä¸‹ï¼Œæ˜¾è‘—æå‡äº†ç”¨æˆ·ä½“éªŒã€‚
